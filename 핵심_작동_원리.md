# SwiftCast í•µì‹¬ ì‘ë™ ì›ë¦¬

## ğŸ” ì „ì²´ íë¦„ ìš”ì•½

```
Claude Code
    â†“ (1) HTTP ìš”ì²­
SwiftCast Proxy (localhost:8080)
    â†“ (2) ìš”ì²­ ê°€ë¡œì±„ê¸°
    â†“ (3) í™œì„± ê³„ì • í™•ì¸
    â†“ (4) Provider ì„ íƒ
    â”œâ”€â†’ Anthropic API (api.anthropic.com)
    â””â”€â†’ GLM API (api.z.ai)
    â†“ (5) SSE ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ ìˆ˜ì‹ 
    â†“ (6) ì‚¬ìš©ëŸ‰ ë°ì´í„° ê¸°ë¡
    â†“ (7) ì‘ë‹µ ì „ë‹¬
Claude Code
```

---

## ğŸ“‹ ë‹¨ê³„ë³„ ìƒì„¸ ì„¤ëª…

### 1ï¸âƒ£ Claude Code ì„¤ì •

**íŒŒì¼**: `%APPDATA%\Claude\settings.json`
```json
{
  "env": {
    "ANTHROPIC_BASE_URL": "http://localhost:8080"
  }
}
```

**íš¨ê³¼**:
- Claude Codeê°€ ì›ë˜ `https://api.anthropic.com/v1/messages`ë¡œ ë³´ë‚´ë˜ ìš”ì²­ì„
- `http://localhost:8080/v1/messages`ë¡œ ë³´ë‚´ê²Œ ë¨
- **Claude CodeëŠ” ë³€ê²½ ì‚¬í•­ì„ ì „í˜€ ëª¨ë¦„** (íˆ¬ëª…í•œ í”„ë¡ì‹œ)

---

### 2ï¸âƒ£ SwiftCast Proxyê°€ ìš”ì²­ ê°€ë¡œì±„ê¸°

**ì½”ë“œ**: `src-tauri/src/proxy/server.rs`

```rust
// localhost:8080 í¬íŠ¸ì—ì„œ ëŒ€ê¸°
let addr = SocketAddr::from(([127, 0, 0, 1], 8080));

// ëª¨ë“  ê²½ë¡œ(/*path)ì— ëŒ€í•œ ìš”ì²­ì„ ì²˜ë¦¬
Router::new()
    .route("/*path", any(proxy_handler))
```

**ê³¼ì •**:
1. Claude Codeê°€ ë³´ë‚¸ HTTP ìš”ì²­ì„ axum ì„œë²„ê°€ ìˆ˜ì‹ 
2. ìš”ì²­ ì •ë³´ ì¶”ì¶œ:
   - Method: POST
   - Path: `/v1/messages`
   - Headers: `content-type: application/json`
   - Body:
     ```json
     {
       "model": "claude-sonnet-4-5-20250929",
       "max_tokens": 1024,
       "messages": [{"role": "user", "content": "ì•ˆë…•í•˜ì„¸ìš”"}]
     }
     ```

---

### 3ï¸âƒ£ í™œì„± ê³„ì • í™•ì¸

**ì½”ë“œ**: `src-tauri/src/proxy/handlers.rs`

```rust
// DBì—ì„œ is_active=trueì¸ ê³„ì • ì¡°íšŒ
let account = state.db.get_active_account().await?;

// ì˜ˆì‹œ ê²°ê³¼:
// Account {
//     id: "2b44dca9-af37-4ed9-88b2-16685ed9bd41",
//     name: "My GLM",
//     base_url: "https://api.z.ai/api/anthropic",
//     is_active: true
// }
```

**ë°ì´í„°ë² ì´ìŠ¤**:
```sql
SELECT * FROM accounts WHERE is_active = 1;
-- ê²°ê³¼: My GLM ê³„ì •
```

**API í‚¤ ë¡œë“œ**:
```rust
// JSON íŒŒì¼ì—ì„œ í•´ë‹¹ ê³„ì •ì˜ API í‚¤ ë¡œë“œ
let api_key = state.secure_storage.get_api_key(&account.id)?;
// ê²°ê³¼: "829fa35e887947fbbc96e1e33eca965c.tPKXfhXXo2TrRs2B"
```

---

### 4ï¸âƒ£ Providerë¡œ ìš”ì²­ í¬ì›Œë”©

**ê³„ì •ë³„ URL ìƒì„±**:
```rust
// base_url + ì›ë˜ ìš”ì²­ ê²½ë¡œ
let target_url = format!("{}{}", account.base_url, path);

// ì˜ˆì‹œ:
// base_url: "https://api.z.ai/api/anthropic"
// path: "/v1/messages"
// â†’ target_url: "https://api.z.ai/api/anthropic/v1/messages"
```

**HTTP ìš”ì²­ ì „ì†¡**:
```rust
let response = state.http_client
    .request(method, &target_url)
    .header("x-api-key", &api_key)  // API í‚¤ ì¶”ê°€
    .header("anthropic-version", "2023-06-01")
    .header("accept", "text/event-stream")
    .json(&body_json)  // ì›ë˜ ìš”ì²­ body ê·¸ëŒ€ë¡œ ì „ë‹¬
    .send()
    .await?;
```

**ì‹¤ì œ ì „ì†¡ë˜ëŠ” ìš”ì²­**:
```
POST https://api.z.ai/api/anthropic/v1/messages
Headers:
  x-api-key: 829fa35e887947fbbc96e1e33eca965c.tPKXfhXXo2TrRs2B
  anthropic-version: 2023-06-01
  content-type: application/json
  accept: text/event-stream
Body:
  {
    "model": "claude-sonnet-4-5-20250929",
    "max_tokens": 1024,
    "messages": [{"role": "user", "content": "ì•ˆë…•í•˜ì„¸ìš”"}]
  }
```

---

### 5ï¸âƒ£ SSE ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ ìˆ˜ì‹ 

**GLM API ì‘ë‹µ (SSE í˜•ì‹)**:
```
event: message_start
data: {"type":"message_start","message":{"id":"msg_123","model":"glm-4.7"}}

event: content_block_start
data: {"type":"content_block_start","index":0,"content_block":{"type":"text","text":""}}

event: content_block_delta
data: {"type":"content_block_delta","index":0,"delta":{"type":"text_delta","text":"ì•ˆë…•"}}

event: content_block_delta
data: {"type":"content_block_delta","index":0,"delta":{"type":"text_delta","text":"í•˜ì„¸ìš”"}}

event: content_block_stop
data: {"type":"content_block_stop","index":0}

event: message_delta
data: {"type":"message_delta","delta":{},"usage":{"output_tokens":5}}

event: message_stop
data: {"type":"message_stop"}
```

**Proxyì—ì„œ ì²˜ë¦¬**:
```rust
// bytes ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ ë³€í™˜
let body_stream = response.bytes_stream();

// ê° chunkë¥¼ ê·¸ëŒ€ë¡œ ì „ë‹¬ (íŒŒì‹±í•˜ì§€ ì•ŠìŒ)
let sse_stream = body_stream.map(|chunk| Ok(chunk));
```

---

### 6ï¸âƒ£ ì‚¬ìš©ëŸ‰ ë°ì´í„° ê¸°ë¡

**SSE íŒŒì‹± ë° í† í° ì¶”ì¶œ**:
```rust
// message_delta ì´ë²¤íŠ¸ì—ì„œ usage ì •ë³´ ì¶”ì¶œ
if event_type == "message_delta" {
    let usage = data["usage"];
    // {"input_tokens": 10, "output_tokens": 5}
}
```

**ë°ì´í„°ë² ì´ìŠ¤ ê¸°ë¡**:
```rust
// usage_logs í…Œì´ë¸”ì— INSERT
state.usage_monitor.record_usage(UsageLog {
    timestamp: chrono::Utc::now().timestamp(),
    account_id: "2b44dca9-af37-4ed9-88b2-16685ed9bd41",
    provider: "GLM",
    model: "glm-4.7",
    input_tokens: 10,
    output_tokens: 5,
    cost_usd: 0.000015,  // ê³„ì‚°ëœ ë¹„ìš©
    duration_ms: 1234,
    request_path: "/v1/messages",
    status_code: 200,
    error_message: None,
}).await?;
```

**SQL ê²°ê³¼**:
```sql
INSERT INTO usage_logs (
    timestamp, account_id, provider, model,
    input_tokens, output_tokens, cost_usd,
    duration_ms, request_path, status_code
) VALUES (
    1737235678, '2b44dca9...', 'GLM', 'glm-4.7',
    10, 5, 0.000015,
    1234, '/v1/messages', 200
);
```

---

### 7ï¸âƒ£ ì‘ë‹µì„ Claude Codeë¡œ ì „ë‹¬

**HTTP ì‘ë‹µ ìƒì„±**:
```rust
Response::builder()
    .status(200)
    .header("content-type", "text/event-stream")
    .header("cache-control", "no-cache")
    .header("connection", "keep-alive")
    .body(Body::wrap_stream(sse_stream))
```

**Claude Codeê°€ ë°›ëŠ” ì‘ë‹µ**:
- ì›ë˜ GLM API ì‘ë‹µê³¼ **ì™„ì „íˆ ë™ì¼**
- Claude CodeëŠ” í”„ë¡ì‹œ ì¡´ì¬ë¥¼ ì „í˜€ ëª¨ë¦„
- SSE ìŠ¤íŠ¸ë¦¬ë°ìœ¼ë¡œ ì‹¤ì‹œê°„ í…ìŠ¤íŠ¸ ìˆ˜ì‹ 

**ê²°ê³¼**:
```
Claude Code í™”ë©´ì— í‘œì‹œ:
"ì•ˆë…•í•˜ì„¸ìš”"
```

---

## ğŸ”„ ê³„ì • ìŠ¤ìœ„ì¹­ ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤: GLM â†’ Anthropic ì „í™˜

**1. ì‚¬ìš©ìê°€ SwiftCast UIì—ì„œ ê³„ì • ì „í™˜**:
```rust
// Tauri command í˜¸ì¶œ
switch_account("anthropic-account-id")
```

**2. ë°ì´í„°ë² ì´ìŠ¤ ì—…ë°ì´íŠ¸**:
```sql
-- ëª¨ë“  ê³„ì • ë¹„í™œì„±í™”
UPDATE accounts SET is_active = 0;

-- Anthropic ê³„ì •ë§Œ í™œì„±í™”
UPDATE accounts SET is_active = 1
WHERE id = 'anthropic-account-id';
```

**3. ë‹¤ìŒ Claude Code ìš”ì²­ë¶€í„° ìë™ ì ìš©**:
```
Claude Code ìš”ì²­
    â†“
Proxyê°€ í™œì„± ê³„ì • í™•ì¸
    â†“ (is_active=1ì¸ ê³„ì • ì¡°íšŒ)
Anthropic ê³„ì • ì„ íƒ
    â†“
https://api.anthropic.com/v1/messages ë¡œ ìš”ì²­
```

**í”„ë¡ì‹œ ì¬ì‹œì‘ ë¶ˆí•„ìš”!** - ë‹¤ìŒ ìš”ì²­ë¶€í„° ìë™ ë°˜ì˜

---

## ğŸ¯ í•µì‹¬ ì„¤ê³„ ì›ì¹™

### 1. **íˆ¬ëª…ì„±** (Transparent Proxy)
- Claude CodeëŠ” í”„ë¡ì‹œ ì¡´ì¬ë¥¼ ëª¨ë¦„
- ìš”ì²­/ì‘ë‹µ í˜•ì‹ ë³€ê²½ ì—†ìŒ
- ì›ë˜ Claude APIì²˜ëŸ¼ ì‘ë™

### 2. **URL ê¸°ë°˜ ë¼ìš°íŒ…**
- `base_url`ë§Œ ë³€ê²½í•˜ë©´ ë‹¤ë¥¸ Provider ì‚¬ìš© ê°€ëŠ¥
- ë³µì¡í•œ Provider ì¶”ìƒí™” ë¶ˆí•„ìš”
- í™•ì¥ ìš©ì´: ìƒˆ Provider ì¶”ê°€ = ìƒˆ ê³„ì • ì¶”ê°€

### 3. **ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë°**
- SSE (Server-Sent Events) ê·¸ëŒ€ë¡œ ì „ë‹¬
- chunk ë‹¨ìœ„ë¡œ íŒŒì‹± ì—†ì´ í¬ì›Œë”©
- ì§€ì—° ì‹œê°„ ìµœì†Œí™”

### 4. **ë¹„ì¹¨íˆ¬ì  ëª¨ë‹ˆí„°ë§**
- í”„ë¡ì‹œ ì‘ë‹µì— ì˜í–¥ ì—†ìŒ
- ì‚¬ìš©ëŸ‰ ê¸°ë¡ì€ ë¹„ë™ê¸°ë¡œ ì²˜ë¦¬
- ì—ëŸ¬ ë°œìƒí•´ë„ í”„ë¡ì‹œ ìš”ì²­ ì‹¤íŒ¨ ì•ˆí•¨

---

## ğŸ“Š ë°ì´í„° íë¦„ ë‹¤ì´ì–´ê·¸ë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Claude Code                              â”‚
â”‚  settings.json: ANTHROPIC_BASE_URL=http://localhost:8080   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ POST /v1/messages
              â”‚ {model, messages, ...}
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SwiftCast Proxy (localhost:8080)                â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 1. ìš”ì²­ ìˆ˜ì‹  (axum server)                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚               â†“                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 2. DB ì¡°íšŒ: SELECT * FROM accounts                   â”‚  â”‚
â”‚  â”‚            WHERE is_active = 1                       â”‚  â”‚
â”‚  â”‚    â†’ My GLM (base_url: api.z.ai/api/anthropic)     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚               â†“                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 3. API í‚¤ ë¡œë“œ: .api_keys.json                      â”‚  â”‚
â”‚  â”‚    â†’ 829fa35e887947fbbc96e1e33eca965c...           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚               â†“                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 4. HTTP ìš”ì²­ ìƒì„±:                                   â”‚  â”‚
â”‚  â”‚    POST https://api.z.ai/api/anthropic/v1/messages  â”‚  â”‚
â”‚  â”‚    Header: x-api-key: 829fa35e...                   â”‚  â”‚
â”‚  â”‚    Body: {ì›ë˜ ìš”ì²­}                                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              GLM API (api.z.ai)                            â”‚
â”‚  - ìš”ì²­ ì²˜ë¦¬                                               â”‚
â”‚  - SSE ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ event: message_start
             â”‚ event: content_block_delta
             â”‚ event: message_delta (usage í¬í•¨)
             â”‚ event: message_stop
             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SwiftCast Proxy                                 â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 5. SSE íŒŒì‹± (ë¹„ë™ê¸°)                                 â”‚  â”‚
â”‚  â”‚    - message_deltaì—ì„œ usage ì¶”ì¶œ                   â”‚  â”‚
â”‚  â”‚    - input_tokens: 10, output_tokens: 5            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚               â†“                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 6. DB ê¸°ë¡ (ë¹„ë™ê¸°, ì—ëŸ¬ ë¬´ì‹œ)                       â”‚  â”‚
â”‚  â”‚    INSERT INTO usage_logs (...)                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 7. SSE ìŠ¤íŠ¸ë¦¼ ì „ë‹¬ (ê·¸ëŒ€ë¡œ)                          â”‚  â”‚
â”‚  â”‚    - chunk ë‹¨ìœ„ë¡œ ì¦‰ì‹œ ì „ë‹¬                         â”‚  â”‚
â”‚  â”‚    - íŒŒì‹±/ë³€í™˜ ì—†ìŒ                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚ HTTP/1.1 200 OK
                â”‚ content-type: text/event-stream
                â”‚ event: message_start...
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Claude Code                              â”‚
â”‚  - SSE ì´ë²¤íŠ¸ ìˆ˜ì‹                                            â”‚
â”‚  - ì‹¤ì‹œê°„ìœ¼ë¡œ í™”ë©´ì— í‘œì‹œ                                     â”‚
â”‚  - "ì•ˆë…•í•˜ì„¸ìš”" ì¶œë ¥                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ í•µì‹¬ ì½”ë“œ ìœ„ì¹˜

### í”„ë¡ì‹œ ì„œë²„
- **íŒŒì¼**: `src-tauri/src/proxy/server.rs`
- **ê¸°ëŠ¥**: axum ì„œë²„ ì‹œì‘, localhost:8080 ë°”ì¸ë”©

### ìš”ì²­ í•¸ë“¤ëŸ¬
- **íŒŒì¼**: `src-tauri/src/proxy/handlers.rs`
- **ê¸°ëŠ¥**: ìš”ì²­ ê°€ë¡œì±„ê¸°, ê³„ì • ì¡°íšŒ, Provider í¬ì›Œë”©

### ë°ì´í„°ë² ì´ìŠ¤
- **íŒŒì¼**: `src-tauri/src/storage/database.rs`
- **í…Œì´ë¸”**: `accounts` (ê³„ì • ì •ë³´), `usage_logs` (ì‚¬ìš©ëŸ‰)

### API í‚¤ ì €ì¥
- **íŒŒì¼**: `.api_keys.json` (JSON)
- **ìœ„ì¹˜**: `%APPDATA%\com.swiftcast.app\.api_keys.json`

### Claude Code ì„¤ì •
- **íŒŒì¼**: `settings.json`
- **ìœ„ì¹˜**: `%APPDATA%\Claude\settings.json`
- **ë‚´ìš©**: `ANTHROPIC_BASE_URL` í™˜ê²½ ë³€ìˆ˜

---

## ğŸ’» ê¸°ìˆ  ì„ íƒ ì´ìœ 

### ì™œ Tauri + Rustì¸ê°€?

#### âœ… í¬ë¡œìŠ¤ í”Œë«í¼ (Windows + macOS)
```
ë‹¨ì¼ ì½”ë“œë² ì´ìŠ¤ â†’ ë¹Œë“œë§Œ ê° OSë³„ë¡œ
- Windows: .exe, .msi
- macOS: .app, .dmg

ë„¤ì´í‹°ë¸Œ ì„±ëŠ¥, ë„¤ì´í‹°ë¸Œ UI
```

#### âœ… ëŸ°íƒ€ì„ ë…ë¦½ (No Dependencies)
**Electronê³¼ ë¹„êµ**:
```
Electron:
  - Node.js ëŸ°íƒ€ì„ í¬í•¨
  - Chromium ì—”ì§„ í¬í•¨
  - íŒŒì¼ í¬ê¸°: ~100-200MB
  - ì„¤ì¹˜ ì‹œ ì¶”ê°€ ëŸ°íƒ€ì„ ë¶ˆí•„ìš”í•˜ì§€ë§Œ íŒŒì¼ í¬ê¸°ê°€ í¼

Tauri:
  - OS ê¸°ë³¸ WebView ì‚¬ìš©
  - Rustë¡œ ì»´íŒŒì¼ (ë„¤ì´í‹°ë¸Œ ë°”ì´ë„ˆë¦¬)
  - íŒŒì¼ í¬ê¸°: ~5-10MB
  - ì¶”ê°€ ëŸ°íƒ€ì„ ì„¤ì¹˜ ë¶ˆí•„ìš” âœ…
```

**Java/Kotlin í”„ë¡œí† íƒ€ì…ê³¼ ë¹„êµ**:
```
Java (Spring Boot):
  - JRE í•„ìš” (ì‚¬ìš©ìê°€ ì„¤ì¹˜í•´ì•¼ í•¨)
  - JRE í¬ê¸°: ~100MB
  - ì‹œì‘ ì‹œê°„: ëŠë¦¼ (JVM ì´ˆê¸°í™”)

Rust (Tauri):
  - ëŸ°íƒ€ì„ ë¶ˆí•„ìš” âœ…
  - ë„¤ì´í‹°ë¸Œ ë°”ì´ë„ˆë¦¬
  - ì‹œì‘ ì‹œê°„: ì¦‰ì‹œ (< 1ì´ˆ)
```

#### âœ… ì™„ì „í•œ ë…ë¦½ ì‹¤í–‰
```
ì‚¬ìš©ì ê´€ì :
1. SwiftCast.msi ë‹¤ìš´ë¡œë“œ
2. ë”ë¸”í´ë¦­ ì„¤ì¹˜
3. ì‹¤í–‰

â†’ ë! (Java, Node.js ë“± ì„¤ì¹˜ ë¶ˆí•„ìš”)
```

---

## âœ… í•µì‹¬ ì›ë¦¬ ìš”ì•½

1. **Claude Code ì„¤ì •**: `ANTHROPIC_BASE_URL=localhost:8080`
2. **í”„ë¡ì‹œê°€ ìš”ì²­ ê°€ë¡œì±„ê¸°**: axum ì„œë²„ê°€ 8080 í¬íŠ¸ ëŒ€ê¸°
3. **í™œì„± ê³„ì • í™•ì¸**: DBì—ì„œ `is_active=1` ê³„ì • ì¡°íšŒ
4. **Provider ì„ íƒ**: ê³„ì •ì˜ `base_url` ì‚¬ìš©
5. **ìš”ì²­ í¬ì›Œë”©**: ì›ë˜ ìš”ì²­ì„ ì„ íƒëœ Providerë¡œ ì „ì†¡
6. **SSE ìŠ¤íŠ¸ë¦¬ë°**: ì‹¤ì‹œê°„ ì‘ë‹µ ìˆ˜ì‹  ë° ì „ë‹¬
7. **ì‚¬ìš©ëŸ‰ ê¸°ë¡**: ë¹„ë™ê¸°ë¡œ DBì— ì €ì¥
8. **íˆ¬ëª…í•œ ì „ë‹¬**: Claude CodeëŠ” ë³€í™” ì—†ìŒ

**í•µì‹¬**: ë‹¨ìˆœ URL êµì²´ + ì‚¬ìš©ëŸ‰ ê¸°ë¡ = ê°•ë ¥í•œ ëª¨ë‹ˆí„°ë§ & ìŠ¤ìœ„ì¹­

**ê¸°ìˆ  ì„ íƒ**: Tauri + Rust = í¬ë¡œìŠ¤ í”Œë«í¼ + ëŸ°íƒ€ì„ ë…ë¦½
