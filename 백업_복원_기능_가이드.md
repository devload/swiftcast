# Claude 설정 백업/복원 기능 가이드

**작성일**: 2026-01-19
**SwiftCast 버전**: 0.1.0

---

## ✅ 구현 완료 사항

### 1. 백엔드 구현 (Rust)
- ✅ `backup_claude_settings()` - Claude 설정 백업
- ✅ `restore_claude_settings()` - 백업에서 복원
- ✅ `list_backups()` - 백업 목록 조회
- ✅ `delete_backup()` - 백업 삭제
- ✅ 파일 경로:
  - Claude 설정: `%APPDATA%\Claude\settings.json`
  - 백업 저장: `%APPDATA%\com.swiftcast.app\backups\`

### 2. 프론트엔드 구현 (React)
- ✅ Dashboard에 "Claude 설정 백업" 섹션 추가
- ✅ "백업 생성" 버튼
- ✅ 백업 목록 표시 (타임스탬프, 파일 크기)
- ✅ 각 백업별 "복원" 및 "삭제" 버튼

---

## 🧪 테스트 방법

### 1단계: Claude 설정 파일 확인

테스트용 설정 파일이 생성되어 있습니다:

```bash
cat "$APPDATA/Claude/settings.json"
```

**현재 내용**:
```json
{"env":{"test":"original"}}
```

### 2단계: SwiftCast 앱에서 백업 생성

1. **SwiftCast 창 확인**
   - 현재 실행 중 (PID: 70648)
   - Dashboard 화면에 "Claude 설정 백업" 섹션이 표시됨

2. **백업 생성**
   - "백업 생성" 버튼 클릭
   - 성공 메시지: "Claude 설정이 백업되었습니다."
   - 백업 목록에 새 항목이 추가됨

3. **백업 파일 확인**
   ```bash
   ls -lh "$APPDATA/com.swiftcast.app/backups/"
   ```

   **예상 파일명**: `settings_backup_1737309600.json` (타임스탬프 포함)

### 3단계: 설정 파일 수정 (복원 테스트용)

```bash
echo '{"env":{"test":"modified"}}' > "$APPDATA/Claude/settings.json"
cat "$APPDATA/Claude/settings.json"
```

**수정된 내용**:
```json
{"env":{"test":"modified"}}
```

### 4단계: 백업에서 복원

1. **백업 목록에서 복원**
   - SwiftCast 앱에서 백업 항목의 "복원" 버튼 클릭
   - 확인 다이얼로그: "백업 파일을 복원하시겠습니까?"
   - "확인" 클릭

2. **복원 성공 메시지**
   - "Claude 설정이 복원되었습니다. Claude Code를 재시작하세요."

3. **복원 확인**
   ```bash
   cat "$APPDATA/Claude/settings.json"
   ```

   **예상 결과** (원래 내용으로 복원):
   ```json
   {"env":{"test":"original"}}
   ```

### 5단계: 백업 삭제

1. **백업 삭제**
   - SwiftCast 앱에서 백업 항목의 "삭제" 버튼 클릭
   - 확인 다이얼로그: "백업 파일을 삭제하시겠습니까?"
   - "확인" 클릭

2. **백업 목록에서 제거 확인**
   - 백업 목록에서 해당 항목이 사라짐

---

## 📋 UI 기능 설명

### Dashboard - Claude 설정 백업 섹션

```
┌─────────────────────────────────────────────────┐
│ Claude 설정 백업              [백업 생성]       │
├─────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────┐ │
│ │ 2026. 1. 19. 오전 1:20:00                   │ │
│ │ 45.0 KB                [복원] [삭제]        │ │
│ └─────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────┐ │
│ │ 2026. 1. 19. 오전 12:30:00                  │ │
│ │ 43.2 KB                [복원] [삭제]        │ │
│ └─────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────┘
```

### 버튼 동작

1. **백업 생성**
   - 현재 `%APPDATA%\Claude\settings.json` 파일을 백업
   - 파일명: `settings_backup_{타임스탬프}.json`
   - 백업 위치: `%APPDATA%\com.swiftcast.app\backups\`

2. **복원**
   - 선택한 백업 파일로 현재 Claude 설정 덮어쓰기
   - 복원 후 Claude Code 재시작 필요

3. **삭제**
   - 백업 파일 영구 삭제
   - 확인 다이얼로그 표시

---

## ⚠️ 주의사항

### 1. Claude Code 재시작 필수
설정을 복원한 후에는 **반드시 Claude Code를 재시작**해야 변경사항이 적용됩니다.

### 2. 백업 시점
다음과 같은 경우 백업을 생성하는 것이 좋습니다:
- SwiftCast 프록시를 처음 설정하기 전
- Claude 설정을 수동으로 수정하기 전
- 정기적인 백업 (예: 주 1회)

### 3. 백업 파일 관리
- 백업은 자동으로 삭제되지 않습니다
- 오래된 백업은 수동으로 삭제하세요
- 백업 파일 크기는 일반적으로 1~100KB

---

## 🔍 트러블슈팅

### 문제 1: "Claude settings.json not found" 에러

**원인**: Claude 설정 파일이 존재하지 않음

**해결**:
```bash
mkdir -p "$APPDATA/Claude"
echo '{}' > "$APPDATA/Claude/settings.json"
```

### 문제 2: 백업 생성 실패

**원인**: 백업 디렉토리 접근 권한 문제

**해결**:
```bash
mkdir -p "$APPDATA/com.swiftcast.app/backups"
```

### 문제 3: 복원 후에도 설정이 적용되지 않음

**원인**: Claude Code가 재시작되지 않음

**해결**: Claude Code를 완전히 종료하고 재시작

---

## 📁 파일 경로 요약

| 항목 | 경로 |
|------|------|
| Claude 설정 | `%APPDATA%\Claude\settings.json` |
| 백업 저장소 | `%APPDATA%\com.swiftcast.app\backups\` |
| 백업 파일 | `settings_backup_{타임스탬프}.json` |

**Windows 기본 경로**:
- `%APPDATA%` = `C:\Users\{사용자명}\AppData\Roaming`

**macOS 기본 경로**:
- `~/Library/Application Support/Claude/settings.json`
- `~/.config/com.swiftcast.app/backups/`

---

## ✅ 테스트 체크리스트

### 자동 테스트 완료 ✅
- [x] Rust 함수 구현
- [x] Tauri commands 등록
- [x] React UI 구현
- [x] 컴파일 성공
- [x] 앱 실행 성공

### 수동 테스트 필요 ⚠️
- [ ] 백업 생성 버튼 클릭 → 백업 파일 생성 확인
- [ ] 백업 목록에 항목 표시 확인
- [ ] 복원 버튼 클릭 → 설정 파일 복원 확인
- [ ] 삭제 버튼 클릭 → 백업 파일 삭제 확인
- [ ] 타임스탬프 포맷 확인 (한국어)
- [ ] 파일 크기 표시 확인

---

## 🎯 다음 단계

1. **사용자 직접 테스트**
   - SwiftCast 앱에서 백업/복원 기능 확인
   - 실제 Claude Code 설정으로 테스트

2. **실제 사용 시나리오**
   - 프록시 설정 전 원본 백업
   - 프록시 해제 시 원본 복원
   - 여러 환경 설정 간 전환

3. **추가 개선 사항 (선택)**
   - 백업 자동 생성 옵션
   - 백업 설명 추가 기능
   - 백업 개수 제한 (오래된 것 자동 삭제)

---

## 📝 구현 코드 위치

- **백엔드**: `C:\swiftcast\src-tauri\src\commands\mod.rs` (140~252줄)
- **프론트엔드**: `C:\swiftcast\src\components\Dashboard.tsx` (1~246줄)
- **등록**: `C:\swiftcast\src-tauri\src\main.rs` (49~52줄)

---

**테스트 완료 후 보고**: 모든 기능이 정상 작동하는지 확인해주세요! 🎉
