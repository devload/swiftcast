# SwiftCast 개발 현황 정리

## 📊 프로젝트 개요

**SwiftCast**: Claude와 GLM을 자유롭게 스위칭하고 사용량을 모니터링하는 데스크톱 애플리케이션

**핵심 기능**:
1. **Provider 스위칭**: Claude ↔ GLM 간 한 번의 클릭으로 전환
2. **사용량 모니터링**: Provider별 토큰, 비용, 시간 추적
3. **프록시 서버**: Claude Code가 선택된 Provider 사용

**기술 스택**:
- Backend: Rust (Tauri 2.x, axum, SQLite)
- Frontend: React + TypeScript + Vite
- 플랫폼: Windows + macOS (크로스 플랫폼)

**핵심 요구사항**:
- ✅ **크로스 플랫폼**: Windows, macOS에서 동일하게 작동
- ✅ **런타임 독립**: JRE, Node.js 등 추가 설치 불필요
- ✅ **단독 실행**: 더블클릭으로 즉시 실행
- ✅ **작은 크기**: 5-10MB (Electron 대비 1/20)

---

## ✅ 완성된 기능

### 1. 백엔드 (Rust) - 100% 완성

#### 프록시 서버 (`src-tauri/src/proxy/`)
- ✅ axum 기반 HTTP 프록시
- ✅ SSE (Server-Sent Events) 스트리밍 지원
- ✅ 포트: 8080 (localhost 바인딩)
- ✅ 자동 시작 기능
- ✅ **테스트 완료**: GLM API 정상 작동

#### 데이터베이스 (`src-tauri/src/storage/database.rs`)
- ✅ SQLite 기반
- ✅ 위치: `%APPDATA%\com.swiftcast.app\data.db`
- ✅ 테이블:
  - `accounts`: 계정 정보
  - `usage_logs`: 사용량 로그 (미사용)
  - `config`: 설정 (proxy_port, auto_start, theme)

#### 계정 관리 (`src-tauri/src/models/account.rs`)
- ✅ 멀티 계정 지원
- ✅ 계정 구조: ID, Name, Base URL, Created At, Is Active
- ✅ API 키 저장: JSON 파일 (`.api_keys.json`)
- ✅ **현재 계정**: "My GLM" (GLM API)

#### Tauri Commands (`src-tauri/src/commands.rs`)
- ✅ `create_account`: 계정 생성
- ✅ `get_accounts`: 계정 목록 조회
- ✅ `get_account`: 특정 계정 조회
- ✅ `delete_account`: 계정 삭제
- ✅ `switch_account`: 계정 전환
- ✅ `get_active_account`: 활성 계정 조회
- ✅ `start_proxy`: 프록시 시작
- ✅ `stop_proxy`: 프록시 중지
- ✅ `get_proxy_status`: 프록시 상태
- ✅ `get_app_config`: 설정 조회
- ✅ `update_app_config`: 설정 업데이트
- ✅ `validate_api_key`: API 키 검증

#### 빌드
- ✅ Debug 빌드: `target/debug/swiftcast.exe` (27.6 MB)
- ✅ Release 빌드: `target/release/swiftcast.exe` (6.4 MB)

---

### 2. 프론트엔드 (React) - 50% 완성

#### 구조 (`src/`)
- ✅ `App.tsx`: 메인 앱 컴포넌트
- ✅ `components/`: UI 컴포넌트 폴더
- ✅ `lib/`: 유틸리티 함수

#### 상태
- ⚠️ **문제**: Vite 개발 서버(port 1420) 필요
- ⚠️ **문제**: 단독 실행 불가 (빌드 미완성)

---

### 3. 설정 및 통합

#### GLM 계정
- ✅ 계정 이름: "My GLM"
- ✅ Base URL: `https://api.z.ai/api/anthropic`
- ✅ API Key: `829fa35e887947fbbc96e1e33eca965c.tPKXfhXXo2TrRs2B`
- ✅ 상태: Active

#### Claude Code 설정
- ✅ 파일: `%APPDATA%\Claude\settings.json`
- ✅ 내용:
```json
{
  "env": {
    "ANTHROPIC_BASE_URL": "http://localhost:8080"
  }
}
```

#### 프록시 테스트
- ✅ 요청: `POST http://localhost:8080/v1/messages`
- ✅ 응답: GLM API (glm-4.7) 정상 작동
- ✅ SSE 스트리밍: 정상
- ✅ 토큰 카운트: 정상

---

### 4. 사용자 도구

#### 배치 파일 (`.bat`)
- ✅ `SwiftCast.bat`: Desktop UI 실행 (npm run tauri:dev)
- ✅ `start_proxy.bat`: 프록시만 시작
- ✅ `stop_proxy.bat`: 프록시 중지
- ✅ `switch_provider.bat`: Provider 전환 (GLM ↔ Anthropic)
- ✅ `status.bat`: 상태 확인
- ✅ `빠른실행_웹대시보드.bat`: 웹 대시보드 실행

#### 예제 스크립트 (`src-tauri/examples/`)
- ✅ `add_account.rs`: 계정 추가 CLI
- ✅ `enable_autostart.rs`: 자동 시작 활성화
- ✅ `test_proxy.rs`: 프록시 테스트

#### 웹 대시보드
- ✅ `dashboard.html`: 브라우저 기반 대시보드
- ✅ 기능: 상태 확인, 계정 정보 표시, 사용법 안내

#### 문서
- ✅ `README.txt`: 사용 가이드
- ✅ `QUICKSTART.txt`: 빠른 시작 가이드
- ✅ `여기를_읽어주세요.txt`: 실행 방법 안내
- ✅ `사용법.txt`: 한글 가이드

---

## ⚠️ 미완성 또는 문제

### 1. Desktop UI 실행 문제
**문제**: SwiftCast.exe를 직접 실행하면 "ERR_CONNECTION_REFUSED"
**원인**: Vite 개발 서버(localhost:1420)가 실행되지 않음
**해결책**: `npm run tauri:dev` 실행 필요

### 2. 릴리스 빌드 미완성
**문제**: 프론트엔드가 포함된 단일 실행파일 미생성
**원인**:
- `dist` 폴더 빌드 안됨
- `tauri.conf.json`의 `frontendDist` 경로 문제
**해결 필요**: 프론트엔드 빌드 후 Tauri 번들 빌드

### 3. 사용량 모니터링 미구현
**상태**: 코드는 있지만 실제 사용 안함
- `UsageMonitor`: 구현됨
- `usage_logs` 테이블: 생성됨
- 실제 로그 기록: 미구현

### 4. 프론트엔드 UI 미완성
**상태**: 기본 구조만 있음
- 계정 관리 페이지: 미완성
- 대시보드 페이지: 미완성
- 설정 페이지: 미완성
- 통계 페이지: 미완성

---

## 🎯 현재 작동 방식

### 방법 1: 백엔드만 사용 (완전 작동)

```
1. 프록시 시작:
   target\debug\swiftcast.exe 실행
   또는 start_proxy.bat

2. Claude Code 재시작

3. 사용:
   Claude Code가 자동으로 GLM API 사용
```

### 방법 2: Desktop UI (부분 작동)

```
1. SwiftCast.bat 실행
   → npm run tauri:dev 시작
   → 30-60초 대기
   → Vite 서버 시작 (port 1420)
   → Desktop 창 열림

2. 주의사항:
   - 터미널 창 유지 필요
   - 첫 실행 느림
```

### 방법 3: 웹 대시보드 (완전 작동)

```
1. 빠른실행_웹대시보드.bat 실행
   → 프록시 자동 시작
   → 브라우저에서 대시보드 열림

2. 장점:
   - 빠름 (즉시)
   - 간단함
   - 모든 정보 확인 가능
```

---

## 📁 디렉토리 구조

```
C:\swiftcast\
├── src/                          # 프론트엔드 (React)
│   ├── App.tsx
│   ├── main.tsx
│   ├── components/
│   └── lib/
│
├── src-tauri/                    # 백엔드 (Rust)
│   ├── src/
│   │   ├── main.rs               # ✅ 완성
│   │   ├── commands.rs           # ✅ 완성
│   │   ├── models/
│   │   │   └── account.rs        # ✅ 완성
│   │   ├── storage/
│   │   │   ├── database.rs       # ✅ 완성
│   │   │   └── keyring.rs        # ✅ 완성
│   │   ├── proxy/
│   │   │   ├── server.rs         # ✅ 완성
│   │   │   └── handlers.rs       # ✅ 완성
│   │   └── monitor/
│   │       └── usage.rs          # ⚠️ 미사용
│   ├── examples/
│   │   ├── add_account.rs        # ✅ 완성
│   │   ├── enable_autostart.rs   # ✅ 완성
│   │   └── test_proxy.rs         # ✅ 완성
│   ├── target/
│   │   ├── debug/
│   │   │   └── swiftcast.exe     # ✅ 27.6MB
│   │   └── release/
│   │       └── swiftcast.exe     # ✅ 6.4MB
│   ├── Cargo.toml
│   └── tauri.conf.json
│
├── SwiftCast.bat                 # Desktop UI 실행
├── start_proxy.bat               # 프록시만 시작
├── stop_proxy.bat                # 프록시 중지
├── switch_provider.bat           # Provider 전환
├── status.bat                    # 상태 확인
├── 빠른실행_웹대시보드.bat        # 웹 대시보드
├── dashboard.html                # 웹 대시보드 HTML
├── README.txt                    # 사용 가이드
├── QUICKSTART.txt                # 빠른 시작
├── 여기를_읽어주세요.txt          # 실행 방법
├── 사용법.txt                    # 한글 가이드
├── package.json
├── vite.config.ts
└── tsconfig.json
```

---

## 🔧 데이터베이스 상태

### 위치
`C:\Users\devlo\AppData\Roaming\com.swiftcast.app\data.db`

### 현재 데이터

#### accounts 테이블
```
id: 2b44dca9-af37-4ed9-88b2-16685ed9bd41
name: My GLM
base_url: https://api.z.ai/api/anthropic
created_at: 1737185421
is_active: 1
```

#### config 테이블
```
proxy_port: 8080
auto_start: true
theme: system
```

#### API Keys 파일
`C:\Users\devlo\AppData\Roaming\com.swiftcast.app\.api_keys.json`
```json
{
  "2b44dca9-af37-4ed9-88b2-16685ed9bd41": "829fa35e887947fbbc96e1e33eca965c.tPKXfhXXo2TrRs2B"
}
```

---

## 🚀 즉시 사용 가능한 방법

### 추천: 백엔드 + 웹 대시보드

```bash
# 1. 프록시 시작
C:\swiftcast\start_proxy.bat

# 2. 대시보드 열기 (선택사항)
C:\swiftcast\dashboard.html

# 3. Claude Code 재시작
# → 자동으로 GLM API 사용!
```

**장점**:
- ✅ 즉시 작동
- ✅ 안정적
- ✅ Desktop UI 없어도 완전히 사용 가능

---

## 📝 다음 단계 (선택사항)

### Option 1: 현재 상태 유지
- 백엔드 프록시만 사용
- 웹 대시보드로 관리
- **가장 간단하고 안정적**

### Option 2: Desktop UI 완성
필요한 작업:
1. 프론트엔드 완성 (React UI 개발)
2. Vite 빌드 설정 수정
3. Tauri 번들 빌드
4. 단일 실행파일 생성

예상 시간: 2-3시간

### Option 3: 기능 추가
- 사용량 모니터링 활성화
- 통계 대시보드
- 더 많은 Provider 지원
- 시스템 트레이 통합

---

## ✅ 결론

**현재 상태**: 프록시 기능은 100% 완성되어 즉시 사용 가능

**작동 방식**:
```
Claude Code → SwiftCast Proxy (localhost:8080) → GLM API
```

**사용 방법**:
1. `start_proxy.bat` 실행
2. Claude Code 재시작
3. 자동으로 GLM 사용! (비용 절감!)

**Desktop UI**: 개발 모드로 실행 가능하지만 완성도 낮음

**추천**: 지금 상태로도 충분히 사용 가능! 🎉
